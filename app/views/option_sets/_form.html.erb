<div class="option_set_form">

  <% if form_mode == :edit %>
    <%= published_warning(@option_set) if @option_set.published? %>
    <%= appears_elsewhere_warning(@option_set) if @option_set.has_questions? %>
  <% end %>

  <%= flash_and_form_errors(@option_set) %>

  <%= elmo_form_for(@option_set) do |f| %>
    <%= f.field(:name, :required => true, :read_only => cannot?(:update_core, @option_set)) %>
    <%= f.field(:geographic, :type => :check_box, :read_only => cannot?(:change_geographic, @option_set)) %>
    <%= f.field(:multi_level, :type => :check_box, :read_only => cannot?(:update_core, @option_set)) %>
    <%= f.field(:option_levels, :partial => "option_levels") %>
    <%= f.field(:options, :required => true, :partial => "options") %>
    <%= f.submit unless ajax_request? %>
  <% end %>
</div>

<%= javascript_doc_ready do %>
  window.osform = new ELMO.Views.OptionSetForm({
    edit_link: <%=j action_link(:edit, '#').to_json.html_safe %>,
    remove_link: <%=j action_link(:remove, '#').to_json.html_safe %>,
    option_set: <%=j @option_set.as_json(:for_option_set_form => true).to_json.html_safe %>,
    suggest_path: <%=j suggest_options_path.to_json.html_safe %>,
    form_mode: <%=j form_mode.to_json.html_safe %>,
    ajax_mode: <%=j ajax_request?.to_json.html_safe %>,
    can_reorder: <%=j can?(:reorder_options, @option_set).to_json.html_safe %>,
    can_remove_options: <%=j can?(:remove_options, @option_set).to_json.html_safe %>
  });
<% end %>
